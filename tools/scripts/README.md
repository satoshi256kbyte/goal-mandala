# é–‹ç™ºç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã¯ã€é–‹ç™ºç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã€ãƒ†ã‚¹ãƒˆã€ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚’è¡Œã†ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

## é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

### 1. ãƒ¡ã‚¤ãƒ³ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

```bash
./tools/scripts/setup.sh
```

**æ©Ÿèƒ½:**

- ä¾å­˜é–¢ä¿‚ãƒã‚§ãƒƒã‚¯ã¨ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
- Dockerç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
- PostgreSQLåˆæœŸåŒ–ç¢ºèª
- cognito-localåˆæœŸåŒ–ç¢ºèª
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨é€²æ—è¡¨ç¤º

**ã‚ªãƒ—ã‚·ãƒ§ãƒ³:**

- `--skip-docker`: Dockerç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚’ã‚¹ã‚­ãƒƒãƒ—
- `--skip-deps`: ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’ã‚¹ã‚­ãƒƒãƒ—
- `--verbose`: è©³ç´°ãªãƒ­ã‚°ã‚’è¡¨ç¤º

### 2. ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

```bash
./tools/scripts/health-check.sh
```

**æ©Ÿèƒ½:**

- é–‹ç™ºç’°å¢ƒã®åŒ…æ‹¬çš„ãªãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
- åŸºæœ¬ä¾å­˜é–¢ä¿‚ã®ç¢ºèª
- Dockerç’°å¢ƒã®çŠ¶æ…‹ç¢ºèª
- PostgreSQLã¨cognito-localã®å‹•ä½œç¢ºèª
- ãƒãƒ¼ãƒˆä½¿ç”¨çŠ¶æ³ã®ç¢ºèª
- å•é¡Œã®è‡ªå‹•æ¤œå‡ºã¨ä¿®å¾©ææ¡ˆ

**ã‚ªãƒ—ã‚·ãƒ§ãƒ³:**

- `--verbose`: è©³ç´°ãªè¨ºæ–­æƒ…å ±ã‚’è¡¨ç¤º
- `--fix`: å•é¡Œã‚’è‡ªå‹•ä¿®å¾©ï¼ˆå¯èƒ½ãªå ´åˆï¼‰

### 3. å€‹åˆ¥ã‚µãƒ¼ãƒ“ã‚¹ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯

#### PostgreSQLæ¥ç¶šç¢ºèª

```bash
./tools/scripts/test-postgres-connection.sh
```

**æ©Ÿèƒ½:**

- PostgreSQLæ¥ç¶šçŠ¶æ…‹ã®è©³ç´°ç¢ºèª
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å­˜åœ¨ç¢ºèª
- UUIDæ‹¡å¼µæ©Ÿèƒ½ç¢ºèª
- æ¨©é™ãƒ†ã‚¹ãƒˆ
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±è¨ˆæƒ…å ±è¡¨ç¤º

**ã‚ªãƒ—ã‚·ãƒ§ãƒ³:**

- `--verbose`: è©³ç´°ãªãƒ­ã‚°ã‚’è¡¨ç¤º
- `--json`: JSONå½¢å¼ã§çµæœã‚’å‡ºåŠ›

#### cognito-localå‹•ä½œç¢ºèª

```bash
./tools/scripts/validate-cognito-local.sh
```

**æ©Ÿèƒ½:**

- cognito-localæ¥ç¶šç¢ºèª
- User Poolè¨­å®šç¢ºèª
- ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ç¢ºèª
- èªè¨¼ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆç¢ºèª
- è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«æ¤œè¨¼
- å¿œç­”æ™‚é–“æ¸¬å®š

**ã‚ªãƒ—ã‚·ãƒ§ãƒ³:**

- `--verbose`: è©³ç´°ãªãƒ­ã‚°ã‚’è¡¨ç¤º
- `--json`: JSONå½¢å¼ã§çµæœã‚’å‡ºåŠ›

### 4. ã‚¨ãƒ©ãƒ¼è¨ºæ–­ãƒ»ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

```bash
./tools/scripts/diagnose-issues.sh
```

**æ©Ÿèƒ½:**

- ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±åé›†
- Dockerç’°å¢ƒã®è©³ç´°è¨ºæ–­
- PostgreSQLã®åŒ…æ‹¬çš„è¨ºæ–­
- cognito-localã®åŒ…æ‹¬çš„è¨ºæ–­
- ç’°å¢ƒå¤‰æ•°ã®ç¢ºèª
- å•é¡Œã®è‡ªå‹•æ¤œå‡ºã¨è§£æ±ºç­–ææ¡ˆ

**ã‚ªãƒ—ã‚·ãƒ§ãƒ³:**

- `--service SERVICE`: ç‰¹å®šã®ã‚µãƒ¼ãƒ“ã‚¹ã®ã¿è¨ºæ–­ (postgres|cognito-local|all)
- `--verbose`: è©³ç´°ãªãƒ­ã‚°ã‚’è¡¨ç¤º
- `--json`: JSONå½¢å¼ã§çµæœã‚’å‡ºåŠ›

**ä½¿ç”¨ä¾‹:**

```bash
# å…¨ã‚µãƒ¼ãƒ“ã‚¹ã®è¨ºæ–­
./tools/scripts/diagnose-issues.sh

# PostgreSQLã®ã¿è¨ºæ–­
./tools/scripts/diagnose-issues.sh --service postgres

# cognito-localã®ã¿è¨ºæ–­
./tools/scripts/diagnose-issues.sh --service cognito-local

# è©³ç´°ãƒ­ã‚°ä»˜ãã§è¨ºæ–­
./tools/scripts/diagnose-issues.sh --verbose

# JSONå½¢å¼ã§çµæœå‡ºåŠ›
./tools/scripts/diagnose-issues.sh --json
```

### 5. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é–¢é€£ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

#### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒæ¤œè¨¼

```bash
./tools/scripts/validate-database-schema.sh
```

**æ©Ÿèƒ½:**

- PostgreSQLæ¥ç¶šç¢ºèª
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å­˜åœ¨ç¢ºèª
- ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¨©é™ç¢ºèª
- æ‹¡å¼µæ©Ÿèƒ½ç¢ºèª
- æ¥ç¶šãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

#### ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿æŠ•å…¥

```bash
./tools/scripts/seed-database.sh
```

**æ©Ÿèƒ½:**

- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã®æŠ•å…¥
- ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®æŠ•å…¥ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
- ãƒ‡ãƒ¼ã‚¿ãƒªã‚»ãƒƒãƒˆæ©Ÿèƒ½ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

**ã‚ªãƒ—ã‚·ãƒ§ãƒ³:**

- `--reset`: æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆ
- `--test-data`: ãƒ†ã‚¹ãƒˆç”¨ãƒ‡ãƒ¼ã‚¿ã‚‚æŠ•å…¥

## çµ±åˆãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ

### 1. ã‚·ãƒ³ãƒ—ãƒ«ç‰ˆçµ±åˆãƒ†ã‚¹ãƒˆï¼ˆæ¨å¥¨ï¼‰

```bash
pnpm run test:integration
# ã¾ãŸã¯
node tools/scripts/integration-test-simple.js
```

**ç‰¹å¾´:**

- è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯
- ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹æ§‹æˆã®ç¢ºèª
- ä¾å­˜é–¢ä¿‚è¨­å®šã®æ¤œè¨¼
- å®Ÿéš›ã®ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ†ã‚¹ãƒˆã¯å®Ÿè¡Œã—ãªã„
- é«˜é€Ÿå®Ÿè¡Œï¼ˆæ•°ç§’ã§å®Œäº†ï¼‰

**ç”¨é€”:**

- è¨­å®šå¤‰æ›´å¾Œã®åŸºæœ¬ç¢ºèª
- CI/CDã§ã®åŸºæœ¬ãƒã‚§ãƒƒã‚¯
- é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å¾Œã®ç¢ºèª

### 2. å®Œå…¨ç‰ˆçµ±åˆãƒ†ã‚¹ãƒˆ

```bash
pnpm run test:integration:full
# ã¾ãŸã¯
node tools/scripts/integration-test-full.js
```

**ç‰¹å¾´:**

- å®Ÿéš›ã®ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- å„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰å®Ÿè¡Œ
- å‹ãƒã‚§ãƒƒã‚¯ãƒ»ãƒªãƒ³ãƒˆãƒ»ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®š
- åŒ…æ‹¬çš„ãªå‹•ä½œç¢ºèª

**ç”¨é€”:**

- æœ¬æ ¼çš„ãªå‹•ä½œç¢ºèª
- ãƒªãƒªãƒ¼ã‚¹å‰ã®æœ€çµ‚ãƒã‚§ãƒƒã‚¯
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®š

### 3. é«˜åº¦ç‰ˆçµ±åˆãƒ†ã‚¹ãƒˆ

```bash
pnpm run test:integration:advanced
# ã¾ãŸã¯
node tools/scripts/integration-test.js
```

**ç‰¹å¾´:**

- æœ€ã‚‚åŒ…æ‹¬çš„ãªãƒ†ã‚¹ãƒˆ
- éåŒæœŸå‡¦ç†ã®è©³ç´°ãƒ†ã‚¹ãƒˆ
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®æ¤œè¨¼
- è©³ç´°ãªãƒ­ã‚°å‡ºåŠ›

**ç”¨é€”:**

- é–‹ç™ºä¸­ã®ãƒ‡ãƒãƒƒã‚°
- è©³ç´°ãªå•é¡Œèª¿æŸ»

### 4. Shellç‰ˆçµ±åˆãƒ†ã‚¹ãƒˆ

```bash
pnpm run test:integration:shell
# ã¾ãŸã¯
bash tools/scripts/integration-test.sh
```

**ç‰¹å¾´:**

- Bashã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ™ãƒ¼ã‚¹
- Node.jsç’°å¢ƒã«ä¾å­˜ã—ãªã„
- ã‚·ãƒ³ãƒ—ãƒ«ãªå®Ÿè£…

**ç”¨é€”:**

- Node.jsç’°å¢ƒãŒä¸å®‰å®šãªå ´åˆ
- ã‚·ãƒ³ãƒ—ãƒ«ãªCIç’°å¢ƒ

## ä½¿ã„åˆ†ã‘ã‚¬ã‚¤ãƒ‰

| çŠ¶æ³ | æ¨å¥¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆ | ç†ç”± |
|------|---------------|------|
| æ—¥å¸¸çš„ãªé–‹ç™º | ã‚·ãƒ³ãƒ—ãƒ«ç‰ˆ | é«˜é€Ÿã§åŸºæœ¬çš„ãªå•é¡Œã‚’æ¤œå‡º |
| è¨­å®šå¤‰æ›´å¾Œ | ã‚·ãƒ³ãƒ—ãƒ«ç‰ˆ | è¨­å®šã®æ•´åˆæ€§ã‚’ç´ æ—©ãç¢ºèª |
| ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆå‰ | å®Œå…¨ç‰ˆ | å®Ÿéš›ã®å‹•ä½œã‚’åŒ…æ‹¬çš„ã«ç¢ºèª |
| ãƒªãƒªãƒ¼ã‚¹å‰ | å®Œå…¨ç‰ˆ | æœ¬ç•ªç’°å¢ƒã§ã®å‹•ä½œã‚’ä¿è¨¼ |
| å•é¡Œèª¿æŸ» | é«˜åº¦ç‰ˆ | è©³ç´°ãªæƒ…å ±ã§å•é¡Œã‚’ç‰¹å®š |
| CI/CD | ã‚·ãƒ³ãƒ—ãƒ«ç‰ˆ | é«˜é€Ÿã§åŸºæœ¬çš„ãªå“è³ªã‚’ä¿è¨¼ |

## ãƒ†ã‚¹ãƒˆå†…å®¹

### å…±é€šãƒ†ã‚¹ãƒˆé …ç›®

- Node.js ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª
- pnpm ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèª
- è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ç¢ºèª
- ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹æ§‹æˆç¢ºèª
- ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ä¾å­˜é–¢ä¿‚ç¢ºèª
- Turboè¨­å®šç¢ºèª

### å®Œå…¨ç‰ˆãƒ»é«˜åº¦ç‰ˆã®è¿½åŠ é …ç›®

- å®Ÿéš›ã®ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- å„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰
- å‹ãƒã‚§ãƒƒã‚¯å®Ÿè¡Œ
- ãƒªãƒ³ãƒˆå®Ÿè¡Œ
- ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®š

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•

#### 1. Node.js ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼

```bash
# asdfä½¿ç”¨æ™‚
asdf install nodejs 23.10.0
asdf local nodejs 23.10.0

# nvmä½¿ç”¨æ™‚
nvm install 23.10.0
nvm use 23.10.0
```

#### 2. pnpm ãŒãªã„

```bash
# npmçµŒç”±ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install -g pnpm

# ã¾ãŸã¯ corepackä½¿ç”¨
corepack enable
corepack prepare pnpm@latest --activate
```

#### 3. ä¾å­˜é–¢ä¿‚ã‚¨ãƒ©ãƒ¼

```bash
# ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
pnpm store prune

# å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
rm -rf node_modules packages/*/node_modules
pnpm install
```

#### 4. ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼

```bash
# shared ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’æœ€åˆã«ãƒ“ãƒ«ãƒ‰
pnpm --filter @goal-mandala/shared run build

# å…¨ä½“ã‚’ãƒ“ãƒ«ãƒ‰
pnpm run build
```

## ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

### æ–°ã—ã„ãƒ†ã‚¹ãƒˆã®è¿½åŠ 

å„ã‚¹ã‚¯ãƒªãƒ—ãƒˆã® `main` é–¢æ•°ã«æ–°ã—ã„ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ ã§ãã¾ã™ï¼š

```javascript
await runTest('æ–°ã—ã„ãƒ†ã‚¹ãƒˆ', async () => {
  // ãƒ†ã‚¹ãƒˆãƒ­ã‚¸ãƒƒã‚¯
});
```

### ãƒ†ã‚¹ãƒˆã®ç„¡åŠ¹åŒ–

ç‰¹å®šã®ãƒ†ã‚¹ãƒˆã‚’ç„¡åŠ¹åŒ–ã™ã‚‹å ´åˆã¯ã€è©²å½“ã™ã‚‹ `runTest` å‘¼ã³å‡ºã—ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã—ã¦ãã ã•ã„ã€‚

### è¨­å®šã®å¤‰æ›´

å„ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ä¸Šéƒ¨ã«ã‚ã‚‹è¨­å®šå€¤ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ã§ã€ãƒ†ã‚¹ãƒˆã®å‹•ä½œã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã¾ã™ã€‚

## ä½¿ç”¨ä¾‹

### åˆå›ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# å®Œå…¨ãªã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
./tools/scripts/setup.sh

# ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å¾Œã®ç¢ºèª
./tools/scripts/health-check.sh
```

### æ—¥å¸¸çš„ãªé–‹ç™º

```bash
# ç’°å¢ƒçŠ¶æ…‹ã®ç¢ºèª
./tools/scripts/health-check.sh

# å•é¡ŒãŒã‚ã‚‹å ´åˆã®è‡ªå‹•ä¿®å¾©
./tools/scripts/health-check.sh --fix

# è©³ç´°ãªè¨ºæ–­æƒ…å ±ãŒå¿…è¦ãªå ´åˆ
./tools/scripts/health-check.sh --verbose

# ç‰¹å®šã®ã‚µãƒ¼ãƒ“ã‚¹ã®è©³ç´°è¨ºæ–­
./tools/scripts/diagnose-issues.sh --service postgres --verbose
./tools/scripts/diagnose-issues.sh --service cognito-local --verbose
```

### Dockerç’°å¢ƒã®ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

```bash
# Dockerç’°å¢ƒã®ã¿å†ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
./tools/scripts/setup.sh --skip-deps

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çŠ¶æ…‹ã®è©³ç´°ç¢ºèª
./tools/scripts/validate-database-schema.sh

# cognito-localçŠ¶æ…‹ã®è©³ç´°ç¢ºèª
./tools/scripts/validate-cognito-local.sh
```

### CI/CDç’°å¢ƒã§ã®ä½¿ç”¨

```bash
# ä¾å­˜é–¢ä¿‚ã®ã¿ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆDockerç’°å¢ƒã‚¹ã‚­ãƒƒãƒ—ï¼‰
./tools/scripts/setup.sh --skip-docker

# åŸºæœ¬çš„ãªãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
./tools/scripts/health-check.sh
```

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•

#### 1. Dockerç’°å¢ƒã®å•é¡Œ

```bash
# Dockerç’°å¢ƒã®ãƒªã‚»ãƒƒãƒˆ
docker-compose down -v
./tools/scripts/setup.sh

# ã‚³ãƒ³ãƒ†ãƒŠã®çŠ¶æ…‹ç¢ºèª
docker-compose ps
docker-compose logs -f
```

#### 2. PostgreSQLæ¥ç¶šã‚¨ãƒ©ãƒ¼

```bash
# PostgreSQLè©³ç´°è¨ºæ–­
./tools/scripts/test-postgres-connection.sh --verbose

# ã¾ãŸã¯åŒ…æ‹¬çš„è¨ºæ–­
./tools/scripts/diagnose-issues.sh --service postgres --verbose

# PostgreSQLå†èµ·å‹•
docker-compose restart postgres

# æ¥ç¶šãƒ†ã‚¹ãƒˆ
docker-compose exec postgres pg_isready -U goal_mandala_user -d goal_mandala_dev
```

#### 3. cognito-localæ¥ç¶šã‚¨ãƒ©ãƒ¼

```bash
# cognito-localè©³ç´°è¨ºæ–­
./tools/scripts/validate-cognito-local.sh --verbose

# ã¾ãŸã¯åŒ…æ‹¬çš„è¨ºæ–­
./tools/scripts/diagnose-issues.sh --service cognito-local --verbose

# cognito-localå†èµ·å‹•
docker-compose restart cognito-local

# æ¥ç¶šãƒ†ã‚¹ãƒˆ
curl -f http://localhost:9229/health
```

#### 4. ç’°å¢ƒå¤‰æ•°ã®å•é¡Œ

```bash
# .envãƒ•ã‚¡ã‚¤ãƒ«ã®å†ä½œæˆ
rm .env
cp .env.example .env

# ç’°å¢ƒå¤‰æ•°ã®ç¢ºèª
./tools/scripts/health-check.sh --verbose
```

#### 5. ä¾å­˜é–¢ä¿‚ã®å•é¡Œ

```bash
# ä¾å­˜é–¢ä¿‚ã®å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
rm -rf node_modules packages/*/node_modules
pnpm install

# ã¾ãŸã¯
./tools/scripts/setup.sh --skip-docker
```

### ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸åˆ¥å¯¾å‡¦æ³•

#### "PostgreSQLã«æ¥ç¶šã§ãã¾ã›ã‚“"

1. Dockerç’°å¢ƒãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª
2. ãƒãƒ¼ãƒˆ5432ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
3. ç’°å¢ƒå¤‰æ•°POSTGRES_PASSWORDãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

#### "cognito-localã«æ¥ç¶šã§ãã¾ã›ã‚“"

1. Dockerç’°å¢ƒãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª
2. ãƒãƒ¼ãƒˆ9229ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
3. cognito-localè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãŒæ­£ã—ã„ã‹ç¢ºèª

#### "ä¾å­˜é–¢ä¿‚ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã›ã‚“"

1. Node.jsã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒæ­£ã—ã„ã‹ç¢ºèªï¼ˆ23.10.0æ¨å¥¨ï¼‰
2. pnpmãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
3. ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã‚’ç¢ºèª

## ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®æ‹¡å¼µ

### æ–°ã—ã„ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã®è¿½åŠ 

`tools/scripts/health-check.sh`ã«æ–°ã—ã„ãƒã‚§ãƒƒã‚¯é …ç›®ã‚’è¿½åŠ ã™ã‚‹å ´åˆï¼š

```bash
# æ–°ã—ã„ãƒã‚§ãƒƒã‚¯é …ç›®ã‚’è¿½åŠ 
echo "ğŸ” æ–°ã—ã„ã‚µãƒ¼ãƒ“ã‚¹ãƒã‚§ãƒƒã‚¯"
echo "======================="

log_info "æ–°ã—ã„ã‚µãƒ¼ãƒ“ã‚¹ã‚’ç¢ºèªä¸­..."
if new_service_check; then
    log_success "æ–°ã—ã„ã‚µãƒ¼ãƒ“ã‚¹ãŒæ­£å¸¸ã§ã™"
else
    log_error "æ–°ã—ã„ã‚µãƒ¼ãƒ“ã‚¹ã«å•é¡ŒãŒã‚ã‚Šã¾ã™"
    record_issue "æ–°ã—ã„ã‚µãƒ¼ãƒ“ã‚¹ã‚¨ãƒ©ãƒ¼"
fi
```

### ã‚«ã‚¹ã‚¿ãƒ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å‡¦ç†ã®è¿½åŠ 

`tools/scripts/setup.sh`ã«ã‚«ã‚¹ã‚¿ãƒ å‡¦ç†ã‚’è¿½åŠ ã™ã‚‹å ´åˆï¼š

```bash
# ã‚«ã‚¹ã‚¿ãƒ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å‡¦ç†
show_progress X Y "ã‚«ã‚¹ã‚¿ãƒ å‡¦ç†"
log_info "ã‚«ã‚¹ã‚¿ãƒ å‡¦ç†ã‚’å®Ÿè¡Œä¸­..."
# ã‚«ã‚¹ã‚¿ãƒ å‡¦ç†ã®ãƒ­ã‚¸ãƒƒã‚¯
log_success "ã‚«ã‚¹ã‚¿ãƒ å‡¦ç†ãŒå®Œäº†ã—ã¾ã—ãŸ"
```

## AWS SAM CLIé–¢é€£ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

### SAM Local APIèµ·å‹•ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

```bash
./tools/scripts/sam-local-start.sh [ã‚ªãƒ—ã‚·ãƒ§ãƒ³]
```

**æ©Ÿèƒ½:**

- AWS SAM CLIã‚’ä½¿ç”¨ã—ãŸãƒ­ãƒ¼ã‚«ãƒ«APIèµ·å‹•
- ä¾å­˜é–¢ä¿‚ã®è‡ªå‹•ãƒ“ãƒ«ãƒ‰
- ãƒ›ãƒƒãƒˆãƒªãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½
- ç’°å¢ƒå¤‰æ•°ã®è‡ªå‹•èª­ã¿è¾¼ã¿
- ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œ

**ã‚ªãƒ—ã‚·ãƒ§ãƒ³:**

- `-p, --port PORT`: APIã‚µãƒ¼ãƒãƒ¼ã®ãƒãƒ¼ãƒˆç•ªå· (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 3001)
- `-h, --host HOST`: APIã‚µãƒ¼ãƒãƒ¼ã®ãƒ›ã‚¹ãƒˆ (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 0.0.0.0)
- `-e, --env ENV`: ç’°å¢ƒè¨­å®š (default|dev|staging|production, ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: default)
- `--no-build`: ãƒ“ãƒ«ãƒ‰ã‚’ã‚¹ã‚­ãƒƒãƒ—
- `--debug`: ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã§å®Ÿè¡Œ
- `--help`: ãƒ˜ãƒ«ãƒ—ã‚’è¡¨ç¤º

**ä½¿ç”¨ä¾‹:**

```bash
# ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã§èµ·å‹•
./tools/scripts/sam-local-start.sh

# ãƒãƒ¼ãƒˆ3002ã§èµ·å‹•
./tools/scripts/sam-local-start.sh -p 3002

# devç’°å¢ƒè¨­å®šã§èµ·å‹•
./tools/scripts/sam-local-start.sh -e dev

# ãƒ“ãƒ«ãƒ‰ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¦èµ·å‹•
./tools/scripts/sam-local-start.sh --no-build

# ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã§èµ·å‹•
./tools/scripts/sam-local-start.sh --debug

# pnpmã‚¹ã‚¯ãƒªãƒ—ãƒˆçµŒç”±ã§èµ·å‹•
pnpm run sam:start
pnpm run sam:start:debug
pnpm run sam:start:dev
```

**æ©Ÿèƒ½è©³ç´°:**

- **ä¾å­˜é–¢ä¿‚ãƒã‚§ãƒƒã‚¯**: AWS SAM CLIã€Node.jsã€pnpmã®å­˜åœ¨ç¢ºèª
- **è‡ªå‹•ãƒ“ãƒ«ãƒ‰**: TypeScriptã®ãƒ“ãƒ«ãƒ‰ã¨ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- **ç’°å¢ƒå¤‰æ•°èª­ã¿è¾¼ã¿**: .envãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã®ç’°å¢ƒå¤‰æ•°è‡ªå‹•èª­ã¿è¾¼ã¿
- **ãƒ›ãƒƒãƒˆãƒªãƒ­ãƒ¼ãƒ‰**: warm-containersæ©Ÿèƒ½ã«ã‚ˆã‚‹é«˜é€Ÿèµ·å‹•
- **è¨­å®šç®¡ç†**: samconfig.tomlã‹ã‚‰ã®è¨­å®šè‡ªå‹•èª­ã¿è¾¼ã¿

## é–‹ç™ºç”¨ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

### 1. Dockerç’°å¢ƒç®¡ç†ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

```bash
./tools/scripts/docker-env.sh [start|stop|restart|status]
```

**æ©Ÿèƒ½:**

- Dockeré–‹ç™ºç’°å¢ƒã®èµ·å‹•ãƒ»åœæ­¢ãƒ»å†èµ·å‹•
- ç’°å¢ƒçŠ¶æ…‹ã®ç¢ºèª
- ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã®è‡ªå‹•å®Ÿè¡Œ
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨è©³ç´°ãƒ­ã‚°

**ä½¿ç”¨ä¾‹:**

```bash
# ç’°å¢ƒèµ·å‹•
./tools/scripts/docker-env.sh start

# ç’°å¢ƒåœæ­¢
./tools/scripts/docker-env.sh stop

# ç’°å¢ƒå†èµ·å‹•
./tools/scripts/docker-env.sh restart

# çŠ¶æ…‹ç¢ºèª
./tools/scripts/docker-env.sh status
```

### 2. ãƒ­ã‚°ç¢ºèªã‚¹ã‚¯ãƒªãƒ—ãƒˆ

```bash
./tools/scripts/docker-logs.sh [service-name] [options]
```

**æ©Ÿèƒ½:**

- å…¨ã‚µãƒ¼ãƒ“ã‚¹ã¾ãŸã¯ç‰¹å®šã‚µãƒ¼ãƒ“ã‚¹ã®ãƒ­ã‚°è¡¨ç¤º
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ­ã‚°ç›£è¦–
- ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
- ãƒ­ã‚°ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½

**ã‚ªãƒ—ã‚·ãƒ§ãƒ³:**

- `-f, --follow`: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¡¨ç¤º
- `-n, --tail N`: æœ€æ–°Nè¡Œã‚’è¡¨ç¤º
- `--errors`: ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã®ã¿è¡¨ç¤º
- `--export`: ãƒ­ã‚°ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
- `--services`: åˆ©ç”¨å¯èƒ½ãªã‚µãƒ¼ãƒ“ã‚¹ä¸€è¦§ã‚’è¡¨ç¤º

**ä½¿ç”¨ä¾‹:**

```bash
# å…¨ã‚µãƒ¼ãƒ“ã‚¹ã®ãƒ­ã‚°ã‚’è¡¨ç¤º
./tools/scripts/docker-logs.sh

# PostgreSQLã®ãƒ­ã‚°ã‚’è¡¨ç¤º
./tools/scripts/docker-logs.sh postgres

# ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ãƒ­ã‚°ã‚’ç›£è¦–
./tools/scripts/docker-logs.sh postgres -f

# ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã®ã¿ã‚’è¡¨ç¤º
./tools/scripts/docker-logs.sh --errors

# ãƒ­ã‚°ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
./tools/scripts/docker-logs.sh --export
```

### 3. ãƒ‡ãƒ¼ã‚¿ãƒªã‚»ãƒƒãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ

```bash
./tools/scripts/docker-reset.sh [command] [options]
```

**æ©Ÿèƒ½:**

- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿ã®ãƒªã‚»ãƒƒãƒˆ
- Cognitoãƒ‡ãƒ¼ã‚¿ã®ãƒªã‚»ãƒƒãƒˆ
- å…¨ãƒ‡ãƒ¼ã‚¿ã®ä¸€æ‹¬ãƒªã‚»ãƒƒãƒˆ
- ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã®æŠ•å…¥
- Dockerç’°å¢ƒã®å®Œå…¨ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

**ã‚³ãƒãƒ³ãƒ‰:**

- `database`: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã¿ãƒªã‚»ãƒƒãƒˆ
- `cognito`: Cognitoã®ã¿ãƒªã‚»ãƒƒãƒˆ
- `all`: å…¨ãƒ‡ãƒ¼ã‚¿ãƒªã‚»ãƒƒãƒˆï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰
- `seed`: ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿æŠ•å…¥
- `cleanup`: å®Œå…¨ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

**ã‚ªãƒ—ã‚·ãƒ§ãƒ³:**

- `-y, --yes`: ç¢ºèªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ã‚¹ã‚­ãƒƒãƒ—

**ä½¿ç”¨ä¾‹:**

```bash
# å…¨ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆ
./tools/scripts/docker-reset.sh

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã¿ãƒªã‚»ãƒƒãƒˆ
./tools/scripts/docker-reset.sh database

# ç¢ºèªãªã—ã§å…¨ãƒ‡ãƒ¼ã‚¿ãƒªã‚»ãƒƒãƒˆ
./tools/scripts/docker-reset.sh all --yes

# ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã‚’æŠ•å…¥
./tools/scripts/docker-reset.sh seed

# å®Œå…¨ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
./tools/scripts/docker-reset.sh cleanup
```

### 4. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç›´æ¥æ¥ç¶šã‚¹ã‚¯ãƒªãƒ—ãƒˆ

```bash
./tools/scripts/docker-db-connect.sh [command] [options]
```

**æ©Ÿèƒ½:**

- psqlã§ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç›´æ¥æ¥ç¶š
- æ¥ç¶šæƒ…å ±ã®è¡¨ç¤º
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§è¡¨ç¤º
- SQLãƒ•ã‚¡ã‚¤ãƒ«ã®å®Ÿè¡Œ
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ»ãƒªã‚¹ãƒˆã‚¢

**ã‚³ãƒãƒ³ãƒ‰:**

- `connect [DB]`: psqlã§æ¥ç¶šï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰
- `info`: æ¥ç¶šæƒ…å ±ã‚’è¡¨ç¤º
- `pgadmin`: pgAdminæ¥ç¶šè¨­å®šã‚’è¡¨ç¤º
- `list-db`: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä¸€è¦§ã‚’è¡¨ç¤º
- `list-tables [DB]`: ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§ã‚’è¡¨ç¤º
- `size [DB]`: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚µã‚¤ã‚ºã‚’è¡¨ç¤º
- `exec-sql FILE [DB]`: SQLãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®Ÿè¡Œ
- `backup [DB]`: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
- `restore FILE [DB]`: ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰ãƒªã‚¹ãƒˆã‚¢

**ä½¿ç”¨ä¾‹:**

```bash
# ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆDBã«æ¥ç¶š
./tools/scripts/docker-db-connect.sh

# ç‰¹å®šã®DBã«æ¥ç¶š
./tools/scripts/docker-db-connect.sh connect goal_mandala_test

# æ¥ç¶šæƒ…å ±ã‚’è¡¨ç¤º
./tools/scripts/docker-db-connect.sh info

# ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§ã‚’è¡¨ç¤º
./tools/scripts/docker-db-connect.sh list-tables

# SQLãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®Ÿè¡Œ
./tools/scripts/docker-db-connect.sh exec-sql schema.sql

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
./tools/scripts/docker-db-connect.sh backup

# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰ãƒªã‚¹ãƒˆã‚¢
./tools/scripts/docker-db-connect.sh restore backup.sql
```

## é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [çµ±åˆãƒ†ã‚¹ãƒˆã‚¬ã‚¤ãƒ‰](../../docs/integration-testing.md)
- [é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—](../../README.md)
- [ãƒ¢ãƒãƒ¬ãƒæ§‹æˆ](../../docs/monorepo-structure.md)
- [Dockerç’°å¢ƒè¨­å®š](../docker/README.md)
