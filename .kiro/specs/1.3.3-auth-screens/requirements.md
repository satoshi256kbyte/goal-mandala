# 要件定義書

## 概要

認証画面実装機能は、ユーザーがシステムにログイン、サインアップ、パスワードリセットを行うためのフロントエンド画面を提供します。Amazon Cognitoと連携した安全で使いやすい認証フローを実現し、ユーザーエクスペリエンスを向上させることを目的とします。

## 要件

### 要件1

**ユーザーストーリー:** 既存ユーザーとして、メールアドレスとパスワードでログインできるようにしたい。そうすることで、自分のマンダラチャートにアクセスできる。

#### 受入基準

1. WHEN ユーザーがログイン画面にアクセスした時 THEN システムはメールアドレスとパスワードの入力フィールドを表示する
2. WHEN ユーザーが有効なメールアドレスとパスワードを入力してログインボタンをクリックした時 THEN システムはCognitoで認証を行い、成功時にTOP画面にリダイレクトする
3. WHEN ユーザーが無効な認証情報を入力した時 THEN システムは適切なエラーメッセージを表示する
4. WHEN ユーザーが必須フィールドを空のままログインを試行した時 THEN システムはバリデーションエラーを表示する
5. WHEN ログイン画面にサインアップリンクが表示されている時 THEN ユーザーはサインアップ画面に遷移できる

### 要件2

**ユーザーストーリー:** 新規ユーザーとして、アカウントを作成できるようにしたい。そうすることで、システムを利用開始できる。

#### 受入基準

1. WHEN ユーザーがサインアップ画面にアクセスした時 THEN システムは名前、メールアドレス、パスワード、パスワード確認の入力フィールドを表示する
2. WHEN ユーザーが有効な情報を入力してサインアップボタンをクリックした時 THEN システムはCognitoでアカウントを作成し、確認メールを送信する
3. WHEN ユーザーがパスワード確認フィールドに異なるパスワードを入力した時 THEN システムはパスワード不一致エラーを表示する
4. WHEN ユーザーがCognitoのパスワードポリシーに違反するパスワードを入力した時 THEN システムは適切なエラーメッセージを表示する
5. WHEN サインアップ画面にログインリンクが表示されている時 THEN ユーザーはログイン画面に遷移できる

### 要件3

**ユーザーストーリー:** パスワードを忘れたユーザーとして、パスワードをリセットできるようにしたい。そうすることで、再度システムにアクセスできる。

#### 受入基準

1. WHEN ユーザーがパスワードリセット画面にアクセスした時 THEN システムはメールアドレスの入力フィールドを表示する
2. WHEN ユーザーが登録済みのメールアドレスを入力してリセットボタンをクリックした時 THEN システムはCognito経由でパスワードリセットメールを送信する
3. WHEN ユーザーが未登録のメールアドレスを入力した時 THEN システムはセキュリティ上の理由で成功メッセージを表示する（実際にはメールは送信されない）
4. WHEN パスワードリセットメールのリンクをクリックした時 THEN ユーザーは新しいパスワード設定画面に遷移する
5. WHEN ユーザーが新しいパスワードを設定した時 THEN システムはパスワードを更新し、ログイン画面にリダイレクトする

### 要件4

**ユーザーストーリー:** システム利用者として、入力フォームでリアルタイムバリデーションを受けたい。そうすることで、送信前にエラーを修正できる。

#### 受入基準

1. WHEN ユーザーがメールアドレスフィールドに無効な形式を入力した時 THEN システムはリアルタイムでメール形式エラーを表示する
2. WHEN ユーザーがパスワードフィールドに入力中の時 THEN システムはパスワード強度インジケーターを表示する
3. WHEN ユーザーが必須フィールドからフォーカスを外した時 AND フィールドが空の場合 THEN システムは必須入力エラーを表示する
4. WHEN ユーザーがパスワード確認フィールドに入力中の時 THEN システムはパスワード一致状況をリアルタイムで表示する
5. WHEN 全ての入力が有効な時 THEN システムは送信ボタンを有効化する

### 要件5

**ユーザーストーリー:** システム利用者として、認証エラーが発生した時に適切なフィードバックを受けたい。そうすることで、問題を理解し対処できる。

#### 受入基準

1. WHEN Cognitoから認証エラーが返された時 THEN システムはユーザーフレンドリーなエラーメッセージを表示する
2. WHEN ネットワークエラーが発生した時 THEN システムは接続エラーメッセージと再試行ボタンを表示する
3. WHEN アカウントがロックされている時 THEN システムは適切な案内メッセージを表示する
4. WHEN メール確認が必要な時 THEN システムは確認メール送信の案内を表示する
5. WHEN エラーメッセージが表示された時 THEN ユーザーは適切なアクションを取ることができる
