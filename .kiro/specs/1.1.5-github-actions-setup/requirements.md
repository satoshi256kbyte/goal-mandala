# 要件ドキュメント

## 概要

GitHub Actionsを使用したCI/CDパイプラインの基本設定を構築し、コード品質の自動チェックとデプロイメントの自動化を実現する。

## 要件

### 要件1

**ユーザーストーリー:** 開発者として、プルリクエスト作成時に自動的にコード品質チェックが実行されることで、品質の高いコードをメインブランチに統合したい

#### 受入基準

1. WHEN プルリクエストが作成された THEN システムは自動的にLintチェックを実行する SHALL
2. WHEN プルリクエストが作成された THEN システムは自動的にTypeScriptの型チェックを実行する SHALL
3. WHEN プルリクエストが作成された THEN システムは自動的にユニットテストを実行する SHALL
4. WHEN Lintエラーが検出された THEN プルリクエストのステータスを失敗にマークする SHALL
5. WHEN 型エラーが検出された THEN プルリクエストのステータスを失敗にマークする SHALL
6. WHEN テストが失敗した THEN プルリクエストのステータスを失敗にマークする SHALL

### 要件2

**ユーザーストーリー:** 開発者として、mainブランチへのマージ時に包括的な品質チェックが実行されることで、本番環境の安定性を保ちたい

#### 受入基準

1. WHEN mainブランチにコードがプッシュされた THEN システムは全パッケージのビルドを実行する SHALL
2. WHEN mainブランチにコードがプッシュされた THEN システムはテストカバレッジを測定する SHALL
3. WHEN mainブランチにコードがプッシュされた THEN システムはE2Eテストを実行する SHALL
4. WHEN テストカバレッジが80%未満の場合 THEN ワークフローを失敗させる SHALL
5. WHEN E2Eテストが失敗した場合 THEN ワークフローを失敗させる SHALL

### 要件3

**ユーザーストーリー:** 開発者として、ローカル環境でGitHub Actionsワークフローをテストできることで、CI/CDパイプラインの開発効率を向上させたい

#### 受入基準

1. WHEN 開発者がactコマンドを実行した THEN ローカル環境でGitHub Actionsワークフローが実行される SHALL
2. WHEN actでワークフローを実行した THEN 実際のGitHub Actions環境と同等の結果が得られる SHALL
3. WHEN actの設定ファイルが存在する THEN ローカル実行時に適切な環境変数が設定される SHALL
4. WHEN actでワークフローが失敗した THEN 失敗理由が明確に表示される SHALL

### 要件4

**ユーザーストーリー:** 開発者として、コミット前に自動的にコード品質チェックが実行されることで、品質の低いコードのコミットを防ぎたい

#### 受入基準

1. WHEN 開発者がコミットを実行した THEN システムは自動的にpre-commitフックを実行する SHALL
2. WHEN pre-commitフックでLintエラーが検出された THEN コミットを中断する SHALL
3. WHEN pre-commitフックで型エラーが検出された THEN コミットを中断する SHALL
4. WHEN pre-commitフックでフォーマットエラーが検出された THEN 自動的にフォーマットを修正する SHALL
5. WHEN huskyが正しく設定されている THEN 全ての開発者環境で一貫したpre-commitチェックが実行される SHALL

### 要件5

**ユーザーストーリー:** プロジェクト管理者として、ブランチ保護ルールが設定されることで、品質チェックを通過していないコードのマージを防ぎたい

#### 受入基準

1. WHEN ブランチ保護ルールが設定されている THEN 必要なステータスチェックが完了するまでマージを禁止する SHALL
2. WHEN プルリクエストレビューが必要な場合 THEN 承認されるまでマージを禁止する SHALL
3. WHEN 管理者権限でのマージが制限されている THEN 管理者でもステータスチェックをバイパスできない SHALL
4. WHEN ブランチが最新でない場合 THEN マージ前に最新の変更を取り込むことを要求する SHALL

### 要件6

**ユーザーストーリー:** 開発チームとして、プルリクエストテンプレートが提供されることで、一貫した品質のプルリクエストを作成したい

#### 受入基準

1. WHEN プルリクエストを作成した THEN 定義されたテンプレートが自動的に適用される SHALL
2. WHEN テンプレートにチェックリストが含まれている THEN 作成者は必要な項目を確認できる SHALL
3. WHEN テンプレートに変更内容の説明欄がある THEN 作成者は変更の詳細を記述できる SHALL
4. WHEN テンプレートにテスト項目がある THEN 作成者はテスト実施状況を報告できる SHALL
