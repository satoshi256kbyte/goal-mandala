# E2Eテスト

このディレクトリには、Playwrightを使用したE2Eテストが含まれています。

## テスト構成

E2Eテストは重要なユーザーフローのみをカバーする最小限の構成になっています：

### コアテストファイル

1. **auth.spec.ts** - 認証フロー
   - ログイン
   - 認証状態の確認
   - ログアウト

2. **goal-creation.spec.ts** - 目標作成フロー
   - 目標入力フォーム
   - バリデーション
   - AI処理への遷移

3. **mandala-editing.spec.ts** - マンダラ編集フロー
   - インライン編集
   - モーダル編集
   - 保存とキャンセル

### サポートファイル

- **fixtures/** - テストデータ
- **helpers/** - テストヘルパー関数
- **mocks/** - モックデータ
- **global-setup.ts** - グローバルセットアップ
- **test-setup.ts** - テストセットアップ

## テスト実行

```bash
# 全E2Eテストを実行
pnpm --filter @goal-mandala/frontend test:e2e

# UIモードで実行
pnpm --filter @goal-mandala/frontend test:e2e:ui

# 特定のテストファイルを実行
pnpm --filter @goal-mandala/frontend playwright test auth.spec.ts
```

## Playwright設定

- **タイムアウト**: 30秒
- **並列実行**: CI では1並列、ローカルでは2並列
- **レポーター**: dot（最小限）
- **トレース**: 失敗時のみ
- **スクリーンショット**: 失敗時のみ
- **ブラウザ**: Chromium のみ

## テスト戦略

E2Eテストは以下の原則に従っています：

1. **最小限のカバレッジ**: 重要なユーザーフローのみをテスト
2. **高速実行**: 目標実行時間は120秒以内
3. **安定性重視**: 不安定なテストは削除または修正
4. **メンテナンス性**: シンプルで理解しやすいテストコード

## 注意事項

- E2Eテストは開発サーバーを自動的に起動します
- モック認証が有効になっています
- テストは独立して実行可能です
- CI環境では自動的にリトライ（最大2回）されます
